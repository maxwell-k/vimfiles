" tests/dbext-hang.vader
" Copyright 2020 Keith Maxwell
" SPDX-License-Identifier: MPL-2.0
"
Execute (Disable jobs):
  call my_dbext#load()
  Save g:dbext_default_job_enable
  let g:dbext_default_job_enable=0
  execute 'DBSetOption job_enable=' g:dbext_default_job_enable

Execute (First select):
  Select 1;

Then (View result):
  DBResultsClose
  buffer Result
  call vim#dbext_mask()

Expect (1 in one column with a header):
  Connection: T(SQLITE)  D(XXXXX)   at XX:XX
  1
  ----------
  1

Execute (Second select):
  Select 2;

Then (View result):
  DBResultsClose
  buffer Result
  call vim#dbext_mask()

Expect (2 in one column with a header):
  Connection: T(SQLITE)  D(XXXXX)   at XX:XX
  2
  ----------
  2

Include: includes/reset-jobs.vader
